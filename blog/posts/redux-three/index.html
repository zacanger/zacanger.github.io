<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/><title>redux notes, part three | Zac Anger&#x27;s Blog</title><meta name="description" content="Because the Redux docs say &quot;Redux is actually really simple!&quot; when sometimes
it&#x27;s not, and because those docs themselves are pretty overwhelming when
you&#x27;re first trying out Redux, I&#x27;m going to attempt to distill the docs and
bits of my own (admittedly limited) personal experience with Redux into a
couple of blog posts."/><meta name="author" content="Zac Anger"/><meta name="keywords" content="blog,design,javascript,js,music,programming,vim,web development,writing,redux,react"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@zacanger"/><meta name="twitter:creator" content="@zacanger"/><meta name="twitter:title" content="redux notes, part three"/><meta name="twitter:description" content="Because the Redux docs say &quot;Redux is actually really simple!&quot; when sometimes
it&#x27;s not, and because those docs themselves are pretty overwhelming when
you&#x27;re first trying out Redux, I&#x27;m going to attempt to distill the docs and
bits of my own (admittedly limited) personal experience with Redux into a
couple of blog posts."/><meta name="twitter:image" content="https://zacanger.com/logo.png"/><meta property="og:type" content="article"/><meta property="og:title" content="redux notes, part three"/><meta property="og:description" content="Because the Redux docs say &quot;Redux is actually really simple!&quot; when sometimes
it&#x27;s not, and because those docs themselves are pretty overwhelming when
you&#x27;re first trying out Redux, I&#x27;m going to attempt to distill the docs and
bits of my own (admittedly limited) personal experience with Redux into a
couple of blog posts."/><meta property="og:site_name" content="https://zacanger.com/blog"/><meta property="og:image" content="https://zacanger.com/logo.png"/><link rel="stylesheet" type="text/css" href="/blog/assets/styles.css"/><link rel="stylesheet" type="text/css" href="/blog/assets/github-gist.css"/></head><body><header><h1><a href="/blog">Zac Anger&#x27;s Blog</a></h1><h2>redux notes, part three</h2><div>06 August, 2016</div></header><div><div><p>Because the Redux docs say &quot;Redux is actually really simple!&quot; when sometimes
it's not, and because those docs themselves are pretty overwhelming when
you're first trying out Redux, I'm going to attempt to distill the docs and
bits of my own (admittedly limited) personal experience with Redux into a
couple of blog posts.</p>
<hr>
<p>Just want to take a second to go over some syntax before going on more about
Redux. A lot of folks who're new to React might also be new to new JavaScript,
so some things might be looking a little unusual.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">const</span> foo = <span class="hljs-string">'bar'</span> <span class="hljs-comment">// is roughly the same as</span>
<span class="hljs-keyword">var</span> foo = <span class="hljs-string">'bar'</span> <span class="hljs-comment">// EXCEPT that you could not then do</span>
foo = <span class="hljs-string">'baz'</span> <span class="hljs-comment">// because you'd be reassigning a const which is not okay.</span>
<span class="hljs-keyword">let</span> asdf = <span class="hljs-string">'ghjkl'</span> <span class="hljs-comment">// is a lot more like var</span>
asdf = <span class="hljs-string">'qwerty'</span> <span class="hljs-comment">// no errors</span>

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span> <span class="hljs-comment">// is kinda like</span>
<span class="hljs-keyword">const</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>) <span class="hljs-comment">// except it's actually just a part of the language now</span>
<span class="hljs-keyword">import</span> { resolve } <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span> <span class="hljs-comment">// is like</span>
<span class="hljs-keyword">const</span> { resolve } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>) <span class="hljs-comment">// which is like</span>
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">var</span> resolve = path.resolve

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> whatever = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {} <span class="hljs-comment">// is like</span>
<span class="hljs-built_in">module</span>.exports.whatever = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> MyThing <span class="hljs-comment">// is like</span>
<span class="hljs-built_in">module</span>.exports = MyThing

<span class="hljs-keyword">const</span>
  a = <span class="hljs-string">'a'</span>
, b = <span class="hljs-string">'b'</span>
, c = <span class="hljs-string">'c'</span>
, o = { a, b, c } <span class="hljs-comment">// is the same as</span>

<span class="hljs-keyword">var</span> a = <span class="hljs-string">'a'</span>
<span class="hljs-keyword">var</span> b = <span class="hljs-string">'b'</span>
<span class="hljs-keyword">var</span> c = <span class="hljs-string">'c'</span>
<span class="hljs-keyword">var</span> o = {
  <span class="hljs-attr">a</span> : a
, <span class="hljs-attr">b</span> : b
, <span class="hljs-attr">c</span> : c
}

<span class="hljs-keyword">const</span> someFunc = <span class="hljs-function"><span class="hljs-params">param</span> =&gt;</span> param <span class="hljs-comment">// is roughly the same as</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someFunc</span>(<span class="hljs-params">param</span>) </span>{
  <span class="hljs-keyword">return</span> param
}
<span class="hljs-comment">// though there _are_ important differences</span>
</code></pre>
<p>If you're not at all familiar with ES2015, you should really go get comfortable
with it. I put together a repo a while ago for that, full of examples and notes.
Check it out <a href="https://github.com/zacanger/es6-and-builds/tree/master">here</a>.
(Also if you want, check out my semi-maintained bunch of examples and resources
for learning React <a href="https://github.com/zacanger/react-bits">here</a>.)</p>
<hr>
<p><code>react-redux</code> (not a part of Redux itself, since it's supposed to be
framework/library agnostic... ish) is something you'll need for writing React
apps using Redux. It sort of enforces the presentational/container (or
dumb/smart) way of structuring your components.</p>
<p>Note—you don't <em>need</em> <code>react-redux</code> to be able to use Redux with React, it
just helps. A lot.</p>
<p>I won't go into the whole presentational/container component thing, there are a
lot of blogs posts and such out there on that topic, but it's basically what it
sounds like; you have components that handle how things look and components that
handle how things work.</p>
<p><code>react-redux</code> gives you this <code>connect()</code> function which is pretty handy. You can
do a lot of the stuff it does by hand using <code>store.subscribe()</code>, but then you
start needing to worry about <code>shouldComponentUpdate</code> and all this stuff, and
it's all kind of annoying.</p>
<p>When wrapping a 'dumb' component up in a 'smart' component, there are two
functions you usually throw in there. One is called <code>mapStateToProps</code>, and the
other is <code>mapDispatchToProps</code>. I'd suggest you take a good look at the <a href="https://github.com/reactjs/react-redux">official
docs</a> on <code>react-redux</code> to get a good
feel for how it all works, but setting up a container component turns out to be
pretty straightforward.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>
<span class="hljs-keyword">import</span> { someReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'./wherever/your/reducers/are'</span>
<span class="hljs-keyword">import</span> AComponent <span class="hljs-keyword">from</span> <span class="hljs-string">'./AComponent'</span>

<span class="hljs-keyword">const</span> mapStateToProps = <span class="hljs-function">(<span class="hljs-params">state, ownProps</span>) =&gt;</span> ({
  <span class="hljs-attr">somethingInState</span>: someReducer(state, ownProps.maybeSomeProperty.Here)
})

<span class="hljs-keyword">const</span> mapDispatchToProps = <span class="hljs-function">(<span class="hljs-params">dispatch, ownProps</span>) =&gt;</span> ({
  <span class="hljs-attr">something</span>: probablyAnActionOrOtherFunction
})

<span class="hljs-keyword">const</span> AComponentThatIsNowConnected = connect(
  mapStateToProps
, mapDispatchToProps
)(AComponent)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> AComponentThatIsNowConnected
</code></pre>
<p><code>mapDispatchToProps</code> is a little tricky, so I'd really suggest just checking out
<a href="https://github.com/reactjs/react-redux/blob/master/docs/api.md">the docs</a>.</p>
<p>There's one other important bit, and that's this thing called <code>Provider</code>. It's a
component that makes the store available to all your container components
without you needing to actually pass it down everywhere. It uses this funky
<a href="https://facebook.github.io/react/docs/context.html">context</a> thing under the
hood. You don't need to put it everywhere, you just wrap a root component in it.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>
<span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>
<span class="hljs-keyword">import</span> reducers <span class="hljs-keyword">from</span> <span class="hljs-string">'./reducers'</span>
<span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./App'</span>

<span class="hljs-keyword">const</span> store = createStore(reducers)
<span class="hljs-keyword">const</span> root = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>)

render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>
, root
)
</code></pre>
<p>This can trip you up when testing! You don't need to do much to work around it,
but it can be annoying the first time you see all these random errors. Try
something like:</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">'ava'</span> <span class="hljs-comment">// seriously awesome test runner</span>
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { mount } <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme'</span> <span class="hljs-comment">// seriously awesome testing thing for React</span>
<span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>
<span class="hljs-keyword">import</span> MyComponent <span class="hljs-keyword">from</span> <span class="hljs-string">'./MyComponent'</span>

test.beforeEach(<span class="hljs-string">'Set up &lt;MyComponent /&gt;'</span>, t =&gt; {
  <span class="hljs-keyword">const</span> store = createStore(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({}))
  t.context = mount(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span>
        <span class="hljs-attr">some</span>=<span class="hljs-string">'props'</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span>
  )
})

// and then you can do
test('<span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span> isn\'t broken!', t =&gt; {
  t.is(t.context.prop('some'), 'props')
})
// and it won't throw errors about not finding a store and stuff!
</span></code></pre>
</div><p><a href="https://github.com/zacanger/zacanger.github.io/issues/new?title=redux notes, part three" target="_blank">Submit a bug report</a></p></div><footer>Made by <a href="/">Zac Anger</a><br/><br/><a href="/blog/rss.xml">Feed</a> · <a href="/LICENSE.txt">License</a> · <a href="https://github.com/zacanger">GitHub</a> · <a href="https://twitter.com/zacanger">Twitter</a> · <a href="https://mastodon.social/@zacanger">Mastodon</a></footer></body></html>