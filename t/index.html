<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>tweetcode</title>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/codemirror.min.css">
  <link rel="stylesheet" type="text/css" href="./css.css">
</head>
<body>
  <canvas
    id="canvas"
    width="600"
    height="800"
    hidden="true">
  </canvas>
  <textarea name="editable" rows="20" cols="60 "id="text" onchange="change()">
#!/usr/bin/env node

const
  http = require('http')
, dns  = require('dns')
, port = process.env.PORT || 5000

http.createServer((req, res) => {
  let ip
  if (req.method === 'GET') {
    ip = req.headers['x-forwarded-for'] || req.connection.remoteAddress
    dns.reverse(ip, handleResponse)
  } else {
    res.writeHeader(501)
    res.end()
  }

  function handleResponse (error, domains) {
    switch (req.headers.accept) {
      case 'application/json':
        const data = {'ip' : ip}
        if (!error && domains.length > 1) {
          data.hostname = domains[0]
        }
        res.writeHead(200, {'content-type' : 'application/json'})
        res.write(JSON.stringify(data))
        res.end()
        break
      default:
        res.writeHead(200, {'content-type' : 'text/plain'})
        res.write(ip)
        res.end()
    }
  }
}).listen(port)
</textarea>
  <div><img id="newImg"></div>
  <button onclick="go()">go</button>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/codemirror.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/addon/edit/matchbrackets.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/addon/comment/continuecomment.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.16.0/mode/javascript/javascript.min.js"></script>
  <script type="text/javascript" src="./js.js"></script>
</body>
</html>
